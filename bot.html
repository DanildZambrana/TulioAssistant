<!-- BOT WIDGET COMPLETO PARA REUTILIZAR EN OTRO PROYECTO -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bot Widget Reutilizable</title>
  <!-- Fuentes premium -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&family=Orbitron:wght@400;700&family=Exo:wght@400;700&family=Audiowide&family=Roboto+Mono:wght@400;700&family=UnifrakturCook:wght@700&family=Black+Ops+One&family=Press+Start+2P&family=Rubik+Mono+One&family=Permanent+Marker&family=Pacifico&family=Zen+Dots&family=Staatliches&family=Fruktur&display=swap" rel="stylesheet">
  <style>
    /* --- TEMA FUTURISTA OSCURO Y NEÓN PARA EL CHATBOT --- */
    .bot-widget {
      background: linear-gradient(135deg, #181c2b 60%, #23243a 100%);
      border-radius: 32px;
      box-shadow: 0 8px 48px 0 #00fff799, 0 2px 24px #0008, 0 0 0 2.5px #00fff7cc;
      border: none;
      color: #e0e6f7;
      min-width: 340px;
      max-width: 98vw;
      overflow: visible;
      position: fixed;
      right: 30px;
      bottom: 30px;
      z-index: 1200;
      display: flex;
      flex-direction: column;
      animation: botWidgetFadeIn 0.5s cubic-bezier(.4,1.4,.6,1) 1;
      transition: box-shadow 0.2s, transform 0.2s;
    }
    .bot-widget::before {
      content: '';
      position: absolute;
      inset: 0;
      z-index: 0;
      border-radius: 32px;
      pointer-events: none;
      background: radial-gradient(ellipse at 80% 10%, #00fff733 0%, #ff00cc22 100%);
      filter: blur(32px) brightness(1.1) saturate(1.2);
      opacity: 0.7;
      z-index: 2;
    }
    .bot-header .bot-gear:hover {
      color: #ff00cc;
      transform: rotate(30deg) scale(1.15);
    }
    .bot-body {
      background: none;
      color: #e0e6f7;
      font-size: 1.13rem;
      padding: 1.3rem 1.3rem 0.9rem 1.3rem;
      min-height: 140px;
      max-height: 380px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 0.7rem;
      scroll-behavior: smooth;
      z-index: 1;
    }
    .bot-body .bot-msg {
      z-index: 2;
      display: flex;
      align-items: flex-end;
      gap: 0.7em;
      margin-bottom: 0.2em;
      animation: floatIn 0.5s cubic-bezier(.4,1.4,.6,1);
    }
    .bot-body .bot-msg.bot .bot-bubble {
      background: linear-gradient(120deg, #23243a 60%, var(--robot-main, #00fff7) 100%);
      color: #fff;
      border-radius: 20px 20px 20px 6px;
      border: 1.5px solid var(--robot-main, #00fff7);
      box-shadow: 0 2px 16px #00fff733, 0 1px 8px #ff00cc33;
      position: relative;
      overflow: visible;
    }
    .bot-body .bot-msg.user .bot-bubble {
      background: linear-gradient(90deg, #ff00cc 60%, #00fff7 100%);
      color: #fff;
      border-radius: 20px 20px 6px 20px;
      border: 1.5px solid #ff00cc;
      box-shadow: 0 2px 16px #ff00cc33, 0 1px 8px #00fff733;
      align-self: flex-end;
    }
    .bot-body .bot-bubble {
      max-width: 80%;
      padding: 0.95em 1.35em;
      font-size: 1.08em;
      word-break: break-word;
      line-height: 1.5;
      position: relative;
      animation: bubbleFloatIn 0.35s cubic-bezier(.4,1.4,.6,1);
      z-index: 2;
    }
    .bot-body .bot-typing {
      font-style: italic;
      color: #00fff7;
      animation: botTypingBlink 1.2s infinite;
    }
    .bot-footer {
      padding: 1rem 1.3rem 1.1rem 1.3rem;
      border-top: 2px solid #00fff7;
      background: none;
      display: flex;
      gap: 0.7rem;
      align-items: center;
      box-shadow: 0 -2px 12px #00fff733;
    }
    .bot-input {
      width: 80%;
      padding: 0.7rem 1rem;
      border-radius: 12px;
      border: 1.5px solid #00fff7;
      font-size: 1.12rem;
      background: #23243a;
      color: #fff;
      outline: none;
      transition: border-color 0.2s, box-shadow 0.2s;
      box-shadow: 0 1px 8px #00fff711;
    }
    .bot-input:focus {
      border-color: #ff00cc;
      box-shadow: 0 0 0 3px #ff00cc33;
    }
    .bot-send {
      padding: 0.7rem 1.5rem;
      background: linear-gradient(90deg, #00fff7 60%, #ff00cc 100%);
      color: #fff;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 800;
      font-size: 1.12rem;
      box-shadow: 0 2px 12px #00fff733, 0 1px 8px #ff00cc33;
      transition: background 0.2s, color 0.2s, box-shadow 0.2s, transform 0.18s;
      letter-spacing: 0.5px;
    }
    .bot-send:hover {
      background: linear-gradient(90deg, #ff00cc 60%, #00fff7 100%);
      color: #fff;
      box-shadow: 0 4px 24px #ff00cc55, 0 2px 12px #00fff733;
      transform: scale(1.08) rotate(-2deg);
    }
    @media (max-width: 700px) {
      .bot-widget { width: 99vw; right: 0.5vw; bottom: 80px; }
      .bot-fab { right: 2vw; }
    }
    /* --- PANEL DE CONFIGURACIÓN FUTURISTA --- */
    .bot-config-panel {
      position: absolute;
      top: 60px;
      right: 24px;
      min-width: 270px;
      background: linear-gradient(135deg, #181c2b 60%, #23243a 100%);
      border-radius: 18px;
      box-shadow: 0 8px 32px #00fff733, 0 2px 16px #ff00cc33;
      border: 2px solid #00fff7;
      padding: 1.2rem 1.2rem 1rem 1.2rem;
      z-index: 1002;
      display: none;
      flex-direction: column;
      gap: 1.1rem;
      color: #fff;
      font-family: 'Montserrat', Arial, sans-serif;
      animation: configPanelIn 0.35s cubic-bezier(.4,1.4,.6,1);
    }
    @keyframes configPanelIn {
      from { opacity: 0; transform: translateY(-30px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }
    .bot-config-panel label {
      font-size: 1.05rem;
      font-weight: 600;
      margin-bottom: 0.3rem;
      color: #00fff7;
    }
    .bot-config-panel select, .bot-config-panel input[type="color"] {
      width: 100%;
      padding: 0.4rem 0.5rem;
      border-radius: 8px;
      border: 1.5px solid #ff00cc;
      background: #23243a;
      color: #fff;
      font-size: 1.05rem;
      margin-bottom: 0.7rem;
      margin-top: 0.1rem;
    }
    /* ... Puedes agregar más CSS según tus necesidades ... */
  </style>
</head>
<body>
  <!-- Botón flotante con avatar SVG 3D animado de Tulio -->
  <button id="botToggleBtn" class="bot-fab" aria-label="Abrir chat de asistencia" style="
    background: linear-gradient(135deg, #181c2b 60%, #23243a 100%);
    box-shadow: 0 0 36px 12px #00fff799, 0 4px 32px #7f00ff77, 0 0 0 8px #00fff733;
    border: 3px solid #00fff7cc;
    width: 92px;
    height: 92px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 1100;
    transition: box-shadow 0.25s, background 0.25s, transform 0.18s;
    overflow: visible;
    border-radius: 50%;
    padding: 0;
  ">
    <span style="
      display: block;
      width: 74px;
      height: 74px;
      border-radius: 50%;
      background: radial-gradient(circle at 60% 40%, #23243a 60%, #00fff7 100%);
      box-shadow: 0 0 32px 8px #00fff799, 0 2px 12px #7f00ff55;
      position: relative;
      animation: botFabPulse 2.2s infinite alternate;
      margin: 0 auto;
      overflow: hidden;
    ">
      <img src="UML-Imagenes.png/Imagen de WhatsApp 2025-07-30 a las 13.22.01_ec68b39f.jpg" alt="Logo Tulio" style="width:74px;height:74px;border-radius:50%;object-fit:cover;box-shadow:0 0 16px #00fff7cc;">
      <span style="
        position: absolute;
        bottom: -18px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 1.1rem;
        color: #fff;
        text-shadow: 0 2px 8px #00fff7cc, 0 1px 0 #2228;
        font-family: 'Orbitron', 'Montserrat', Arial, sans-serif;
        letter-spacing: 1px;
        font-weight: 700;
        pointer-events: none;
        opacity: 0.92;
        text-align: center;
        width: 80px;
        line-height: 1.1;
      ">Tulio</span>
    </span>
  </button>
  <div class="bot-widget" id="botWidget" style="display:none;">
    <div class="bot-header">
      <div style="display:flex;flex-direction:column;align-items:center;gap:0.1em;width:100%;padding-top:0.7em;padding-bottom:0.2em;">
        <!-- Logo del bot como imagen -->
        <span id="genkubAvatar3D" style="display:block;width:74px;height:74px;margin:0 auto;overflow:hidden;border-radius:50%;box-shadow:0 0 16px #00eaffcc;">
          <img src="UML-Imagenes.png/Imagen de WhatsApp 2025-07-30 a las 13.22.01_ec68b39f.jpg" alt="Logo Tulio" style="width:74px;height:74px;border-radius:50%;object-fit:cover;">
        </span>
        <div id="genkubBotText" style="margin-top:0.1em;text-align:center;font-size:1em;font-family:'Orbitron',sans-serif;color:#00f2ff;line-height:1.1;">¡Hola, soy Tulio ai asisten-UML!</div>
      </div>
      <button id="botConfigBtn" class="bot-gear" aria-label="Configuración" title="Configuración">&#9881;</button>
      <button id="botCloseBtn" class="bot-close" aria-label="Cerrar chat">&times;</button>
    <div class="bot-config-panel" id="botConfigPanel">
      <button id="botConfigCloseBtn" style="background:none;border:none;position:absolute;top:10px;left:10px;font-size:1.7rem;color:#00fff7;cursor:pointer;z-index:10;" title="Cerrar configuración">⟵</button>
      <label style="display:flex;justify-content:space-between;align-items:center;">Tema visual:
        <select id="botThemeSelector">
          <option value="futurista">Futurista</option>
          <option value="cyberpunk">Cyberpunk</option>
          <option value="minimalista">Minimalista</option>
          <option value="glass">Glassmorphism</option>
          <option value="aurora">Aurora</option>
          <option value="neon">Neon Dark</option>
          <option value="rainbow">Rainbow</option>
          <option value="gold">Gold Black</option>
          <option value="matrix">Matrix</option>
          <option value="pastel">Pastel Dream</option>
          <option value="galaxy">Galaxy Night</option>
          <option value="lava">Lava Flow</option>
          <option value="aqua">Aqua Blue</option>
          <option value="sunset">Sunset Vibes</option>
          <option value="mint">Mint Candy</option>
          <option value="peach">Peach Cream</option>
          <option value="ice">Ice Crystal</option>
          <option value="forest">Forest Emerald</option>
          <option value="berry">Berry Punch</option>
          <option value="retro">Retro 80s</option>
        </select>
      </label>
      <div style="margin-bottom:0.7em;">
        <div style="font-weight:600;color:#00fff7;margin-bottom:0.3em;">Colores premium únicos:</div>
        <div id="botColorPalette" style="display:flex;gap:0.5em;flex-wrap:wrap;">
          <!-- Incluye aquí los botones de colores premium -->
        </div>
      </div>
      <label style="display:flex;justify-content:space-between;align-items:center;">Color personalizado:
        <input type="color" id="genkubColorPicker" value="#00f2ff">
      </label>
      <label style="display:flex;justify-content:space-between;align-items:center;">Fuente:
        <select id="genkubFontSelector">
          <option value="Montserrat, Arial, sans-serif">Montserrat</option>
          <option value="Orbitron, Arial, sans-serif">Orbitron</option>
          <option value="Exo, Arial, sans-serif">Exo</option>
          <option value="Audiowide, Arial, sans-serif">Audiowide</option>
          <option value="Roboto Mono, Arial, monospace">Roboto Mono</option>
          <option value="UnifrakturCook, cursive">UnifrakturCook (Gótica)</option>
          <option value="Black Ops One, cursive">Black Ops One</option>
          <option value="Press Start 2P, cursive">Press Start 2P</option>
          <option value="Rubik Mono One, Arial, sans-serif">Rubik Mono One</option>
          <option value="Permanent Marker, cursive">Permanent Marker</option>
          <option value="Pacifico, cursive">Pacifico</option>
          <option value="Zen Dots, Arial, sans-serif">Zen Dots</option>
          <option value="Staatliches, Arial, sans-serif">Staatliches</option>
          <option value="Fruktur, cursive">Fruktur</option>
        </select>
      </label>
      <label style="display:flex;justify-content:space-between;align-items:center;">Expresión:
        <select id="genkubFaceSelector">
          <option value="default">Normal</option>
          <option value="friendly">Amigable</option>
          <option value="serious">Serio</option>
          <option value="cool">Broder 😎</option>
        </select>
      </label>
      <label style="display:flex;justify-content:space-between;align-items:center;">Texto del bot:
        <input type="text" id="genkubTextInput" placeholder="¿En qué te ayudo?">
      </label>
      <button id="genkubSpeakBtn" style="background:#00f2ff;color:black;font-weight:bold;cursor:pointer;margin-top:0.5em;">🔊 Hablar</button>
    </div>
    <div class="bot-body" id="botBody">
      <div class="bot-msg bot">
        <div class="bot-bubble">¡Hola! ¿En qué puedo ayudarte?</div>
      </div>
      <div class="bot-msg bot bot-typing-msg" id="botTypingMsg" style="display:none;">
        <div class="bot-bubble bot-typing-bubble">
          <span class="bot-typing-dots">
            <span>.</span><span>.</span><span>.</span>
          </span>
        </div>
      </div>
    </div>
    <div class="bot-footer glass-footer">
      <div class="input-glass-wrap">
        <input class="bot-input glass-input" id="botInput" type="text" placeholder="Escribe tu mensaje..." autocomplete="off" />
        <button class="bot-send glass-send" onclick="enviarMensaje()">
          <span>Enviar</span>
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none" style="margin-left:7px;vertical-align:middle;"><defs><linearGradient id="sendGrad" x1="0" y1="0" x2="22" y2="22" gradientUnits="userSpaceOnUse"><stop stop-color="#00fff7"/><stop offset="1" stop-color="#ff00cc"/></linearGradient></defs><path d="M3 19L20 11L3 3V10L15 11L3 12V19Z" fill="url(#sendGrad)"/></svg>
        </button>
      </div>
    </div>
  </div>
  <script>
    // --- FUNCIONALIDAD COMPLETA DEL BOT ---
    // Panel de configuración funcional
    function toggleBotConfigPanel(forceOpen) {
      const panel = document.getElementById('botConfigPanel');
      if (forceOpen === true) {
        panel.classList.add('active');
        return;
      }
      if (forceOpen === false) {
        panel.classList.remove('active');
        return;
      }
      panel.classList.toggle('active');
    }

    // Listeners para abrir/cerrar el panel de configuración
    document.addEventListener('DOMContentLoaded', function() {
      const configBtn = document.getElementById('botConfigBtn');
      const closeBtn = document.getElementById('botConfigCloseBtn');
      if (configBtn) {
        configBtn.onclick = function(e) {
          e.preventDefault();
          toggleBotConfigPanel(true);
        };
      }
      if (closeBtn) {
        closeBtn.onclick = function() {
          toggleBotConfigPanel(false);
        };
      }
    });

    // Temas visuales para el bot (completo)
    const botThemes = {
      futurista: {
        '--bot-bg': 'linear-gradient(135deg, #181c2b 60%, #23243a 100%)',
        '--bot-header-bg': 'rgba(0,80,158,0.82)',
        '--bot-main': '#00fff7',
        '--bot-accent': '#ff00cc',
        '--bot-footer-bg': 'rgba(30,30,40,0.55)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ff00cc 60%, #00fff7 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #23243a 60%, #00fff7 100%)',
      },
      cyberpunk: {
        '--bot-bg': 'linear-gradient(135deg, #1a0033 60%, #ff00cc 100%)',
        '--bot-header-bg': '#ff00cc',
        '--bot-main': '#00fff7',
        '--bot-accent': '#ffea00',
        '--bot-footer-bg': 'rgba(40,0,60,0.7)',
        '--bot-font': 'Audiowide, Orbitron, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ffea00 60%, #00fff7 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #1a0033 60%, #ff00cc 100%)',
      },
      minimalista: {
        '--bot-bg': '#fff',
        '--bot-header-bg': '#222',
        '--bot-main': '#222',
        '--bot-accent': '#888',
        '--bot-footer-bg': '#f4f6fb',
        '--bot-font': 'Roboto Mono, Arial, sans-serif',
        '--bot-user-bubble': '#e0e6f7',
        '--bot-bot-bubble': '#f4f6fb',
      },
      glass: {
        '--bot-bg': 'rgba(255,255,255,0.18)',
        '--bot-header-bg': 'rgba(0,80,158,0.32)',
        '--bot-main': '#00fff7',
        '--bot-accent': '#ff00cc',
        '--bot-footer-bg': 'rgba(255,255,255,0.22)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'rgba(255,255,255,0.55)',
        '--bot-bot-bubble': 'rgba(0,255,247,0.18)',
        '--bot-blur': 'blur(16px) saturate(1.3)',
      },
      aurora: {
        '--bot-bg': 'linear-gradient(120deg, #1ec773 0%, #00509e 40%, #fbc02d 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #00fff7 0%, #ff00cc 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#ff00cc',
        '--bot-footer-bg': 'linear-gradient(90deg, #1ec773 0%, #fbc02d 100%)',
        '--bot-font': 'Exo, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #fbc02d 0%, #1ec773 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #00509e 0%, #00fff7 100%)',
      },
      neon: {
        '--bot-bg': 'linear-gradient(135deg, #0f2027 0%, #2c5364 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #ff00cc 0%, #00fff7 100%)',
        '--bot-main': '#00fff7',
        '--bot-accent': '#ff00cc',
        '--bot-footer-bg': 'rgba(30,30,40,0.85)',
        '--bot-font': 'Audiowide, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ff00cc 60%, #00fff7 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #23243a 60%, #00fff7 100%)',
        '--bot-glow': '0 0 16px #00fff7, 0 0 32px #ff00cc',
      },
      rainbow: {
        '--bot-bg': 'linear-gradient(270deg, #ff00cc, #00fff7, #fbc02d, #ff9800, #1ec773, #ff00cc)',
        '--bot-header-bg': 'linear-gradient(90deg, #ff00cc, #00fff7, #fbc02d)',
        '--bot-main': '#fff',
        '--bot-accent': '#ff00cc',
        '--bot-footer-bg': 'linear-gradient(90deg, #ff00cc, #00fff7, #fbc02d)',
        '--bot-font': 'Orbitron, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ff00cc, #00fff7, #fbc02d)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #00fff7, #fbc02d, #ff00cc)',
      },
      gold: {
        '--bot-bg': 'linear-gradient(135deg, #222 60%, #fbc02d 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #fbc02d 0%, #222 100%)',
        '--bot-main': '#fbc02d',
        '--bot-accent': '#fff',
        '--bot-footer-bg': 'linear-gradient(90deg, #222 0%, #fbc02d 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #fbc02d 60%, #fff 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #222 60%, #fbc02d 100%)',
      },
      matrix: {
        '--bot-bg': 'linear-gradient(135deg, #0f2027 60%, #1ec773 100%)',
        '--bot-header-bg': '#1ec773',
        '--bot-main': '#1ec773',
        '--bot-accent': '#fff',
        '--bot-footer-bg': 'rgba(30,30,40,0.85)',
        '--bot-font': 'Roboto Mono, Arial, monospace',
        '--bot-user-bubble': 'linear-gradient(90deg, #1ec773 60%, #222 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #222 60%, #1ec773 100%)',
      },
      pastel: {
        '--bot-bg': 'linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #fbc2eb 0%, #a6c1ee 100%)',
        '--bot-main': '#a6c1ee',
        '--bot-accent': '#fbc2eb',
        '--bot-footer-bg': 'linear-gradient(90deg, #fbc2eb 0%, #a6c1ee 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #fbc2eb 60%, #a6c1ee 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #a6c1ee 60%, #fbc2eb 100%)',
      },
      galaxy: {
        '--bot-bg': 'radial-gradient(ellipse at 70% 20%, #2b1055 0%, #7597de 60%, #1b1b2f 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #120136 0%, #5f00ba 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#a18cd1',
        '--bot-footer-bg': 'linear-gradient(90deg, #120136 0%, #5f00ba 100%)',
        '--bot-font': 'Orbitron, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #a18cd1 0%, #fbc2eb 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #7597de 60%, #2b1055 100%)',
      },
      lava: {
        '--bot-bg': 'linear-gradient(135deg, #ff512f 0%, #dd2476 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #ff512f 0%, #f09819 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#ff512f',
        '--bot-footer-bg': 'linear-gradient(90deg, #f09819 0%, #ff512f 100%)',
        '--bot-font': 'Audiowide, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ff512f 0%, #f09819 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #dd2476 60%, #ff512f 100%)',
      },
      aqua: {
        '--bot-bg': 'linear-gradient(135deg, #43cea2 0%, #185a9d 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #43cea2 0%, #185a9d 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#43cea2',
        '--bot-footer-bg': 'linear-gradient(90deg, #43cea2 0%, #185a9d 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #43cea2 0%, #185a9d 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #185a9d 60%, #43cea2 100%)',
      },
      sunset: {
        '--bot-bg': 'linear-gradient(135deg, #ff9966 0%, #ff5e62 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #ff9966 0%, #ff5e62 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#ff5e62',
        '--bot-footer-bg': 'linear-gradient(90deg, #ff9966 0%, #ff5e62 100%)',
        '--bot-font': 'Exo, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ff9966 0%, #ff5e62 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #ff5e62 60%, #ff9966 100%)',
      },
      mint: {
        '--bot-bg': 'linear-gradient(135deg, #a8ff78 0%, #78ffd6 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #a8ff78 0%, #78ffd6 100%)',
        '--bot-main': '#222',
        '--bot-accent': '#78ffd6',
        '--bot-footer-bg': 'linear-gradient(90deg, #a8ff78 0%, #78ffd6 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #a8ff78 0%, #78ffd6 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #78ffd6 60%, #a8ff78 100%)',
      },
      peach: {
        '--bot-bg': 'linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #ffecd2 0%, #fcb69f 100%)',
        '--bot-main': '#222',
        '--bot-accent': '#fcb69f',
        '--bot-footer-bg': 'linear-gradient(90deg, #ffecd2 0%, #fcb69f 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ffecd2 0%, #fcb69f 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #fcb69f 60%, #ffecd2 100%)',
      },
      ice: {
        '--bot-bg': 'linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #e0eafc 0%, #cfdef3 100%)',
        '--bot-main': '#185a9d',
        '--bot-accent': '#cfdef3',
        '--bot-footer-bg': 'linear-gradient(90deg, #e0eafc 0%, #cfdef3 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #e0eafc 0%, #cfdef3 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #cfdef3 60%, #e0eafc 100%)',
      },
      forest: {
        '--bot-bg': 'linear-gradient(135deg, #11998e 0%, #38ef7d 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #11998e 0%, #38ef7d 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#11998e',
        '--bot-footer-bg': 'linear-gradient(90deg, #11998e 0%, #38ef7d 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #11998e 0%, #38ef7d 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #38ef7d 60%, #11998e 100%)',
      },
      berry: {
        '--bot-bg': 'linear-gradient(135deg, #f857a6 0%, #ff5858 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #f857a6 0%, #ff5858 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#f857a6',
        '--bot-footer-bg': 'linear-gradient(90deg, #f857a6 0%, #ff5858 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #f857a6 0%, #ff5858 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #ff5858 60%, #f857a6 100%)',
      },
      retro: {
        '--bot-bg': 'linear-gradient(135deg, #fc466b 0%, #3f5efb 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #fc466b 0%, #3f5efb 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#fc466b',
        '--bot-footer-bg': 'linear-gradient(90deg, #fc466b 0%, #3f5efb 100%)',
        '--bot-font': 'Orbitron, Audiowide, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #fc466b 0%, #3f5efb 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #3f5efb 60%, #fc466b 100%)',
      }
    };

    function applyBotTheme(themeName) {
      const theme = botThemes[themeName];
      if (!theme) return;
      const root = document.documentElement;
      for (const key in theme) {
        root.style.setProperty(key, theme[key]);
      }
      document.querySelectorAll('.bot-body .bot-msg.user .bot-bubble').forEach(el => {
        el.style.background = theme['--bot-user-bubble'];
      });
      document.querySelectorAll('.bot-body .bot-msg.bot .bot-bubble').forEach(el => {
        el.style.background = theme['--bot-bot-bubble'];
      });
      const widget = document.querySelector('.bot-widget');
      if (widget) widget.style.background = theme['--bot-bg'];
      const header = document.querySelector('.bot-header');
      if (header) header.style.background = theme['--bot-header-bg'];
      const footer = document.querySelector('.bot-footer');
      if (footer) footer.style.background = theme['--bot-footer-bg'];
      if (widget) widget.style.fontFamily = theme['--bot-font'];
    }

    // Mostrar/Ocultar animación escribiendo
    function mostrarEscribiendo(mostrar=true) {
      const typingMsg = document.getElementById('botTypingMsg');
      if (typingMsg) typingMsg.style.display = mostrar ? '' : 'none';
    }

    // Abrir/cerrar el bot flotante
    document.addEventListener('DOMContentLoaded', function() {
      const botWidget = document.getElementById('botWidget');
      const botToggleBtn = document.getElementById('botToggleBtn');
      const botCloseBtn = document.getElementById('botCloseBtn');
      if (botToggleBtn && botWidget) {
        botToggleBtn.onclick = function() {
          botWidget.style.display = 'flex';
          botWidget.style.transform = 'scale(0.8)';
          setTimeout(() => {
            botWidget.style.transform = 'scale(1)';
            document.getElementById('botInput').focus();
          }, 10);
          botToggleBtn.style.display = 'none';
        };
      }
      if (botCloseBtn && botWidget && botToggleBtn) {
        botCloseBtn.onclick = function() {
          botWidget.style.transform = 'scale(0.8)';
          setTimeout(() => {
            botWidget.style.display = 'none';
            botToggleBtn.style.display = 'flex';
          }, 180);
        };
      }
      // Escape para cerrar
      document.addEventListener('keydown', function(e) {
        if(botWidget.style.display === 'flex' && e.key === 'Escape') {
          botWidget.style.transform = 'scale(0.8)';
          setTimeout(() => {
            botWidget.style.display = 'none';
            botToggleBtn.style.display = 'flex';
          }, 180);
        }
      });
      // Enter para enviar mensaje
      document.getElementById('botInput').addEventListener('keydown', function(e) {
        if(e.key === 'Enter') enviarMensaje();
      });
    });

    // Hacer la ventana del bot arrastrable
    document.addEventListener('DOMContentLoaded', function() {
      let isDragging = false, dragOffsetX = 0, dragOffsetY = 0;
      const botWidget = document.getElementById('botWidget');
      const header = botWidget.querySelector('.bot-header');
      header.style.cursor = 'move';
      header.addEventListener('mousedown', function(e) {
        isDragging = true;
        botWidget.classList.add('dragging');
        const rect = botWidget.getBoundingClientRect();
        dragOffsetX = e.clientX - rect.left;
        dragOffsetY = e.clientY - rect.top;
        document.body.style.userSelect = 'none';
      });
      document.addEventListener('mousemove', function(e) {
        if(isDragging) {
          let x = e.clientX - dragOffsetX;
          let y = e.clientY - dragOffsetY;
          x = Math.max(0, Math.min(window.innerWidth - botWidget.offsetWidth, x));
          y = Math.max(0, Math.min(window.innerHeight - botWidget.offsetHeight, y));
          botWidget.style.left = x + 'px';
          botWidget.style.top = y + 'px';
          botWidget.style.right = 'auto';
          botWidget.style.bottom = 'auto';
          botWidget.style.position = 'fixed';
        }
      });
      document.addEventListener('mouseup', function() {
        if(isDragging) {
          isDragging = false;
          botWidget.classList.remove('dragging');
          document.body.style.userSelect = '';
        }
      });
    });

    // Simulación de envío de mensaje (puedes conectar a tu backend aquí)
    async function enviarMensaje() {
      const input = document.getElementById('botInput');
      const body = document.getElementById('botBody');
      const userMsg = input.value.trim();
      if(userMsg !== '') {
        const userDiv = document.createElement('div');
        userDiv.className = 'bot-msg user';
        userDiv.innerHTML = `<div class="bot-bubble">${userMsg}</div>`;
        body.appendChild(userDiv);
        body.scrollTop = body.scrollHeight;
        input.value = '';
        // Mostrar indicador de "escribiendo"
        const loadingId = 'bot-loading-' + Date.now();
        const botDiv = document.createElement('div');
        botDiv.className = 'bot-msg bot';
        botDiv.id = loadingId;
        botDiv.innerHTML = `<div class="bot-bubble"><span class='bot-typing'>Escribiendo...</span></div>`;
        body.appendChild(botDiv);
        body.scrollTop = body.scrollHeight;
        try {
          const response = await fetch('https://automate.danild.dev/webhook/chatbot', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ question: userMsg })
          });
          let data = await response.json();
          let respuesta = data.reply || data.response || data.answer;
          // Si sigue sin respuesta, busca la primera propiedad string
          if (!respuesta && typeof data === 'object' && data !== null) {
            for (const key in data) {
              if (typeof data[key] === 'string' && data[key].length > 0) {
                respuesta = data[key];
                break;
              }
            }
          }
          if (respuesta) {
            botDiv.innerHTML = `<div class="bot-bubble">${respuesta}</div>`;
          } else {
            botDiv.innerHTML = `<div class="bot-bubble" style='color:red;'>No se pudo interpretar la respuesta del servidor.</div>`;
          }
        } catch (err) {
          botDiv.innerHTML = `<div class="bot-bubble" style='color:red;'>Error de conexión. Intenta de nuevo.</div>`;
        }
        body.scrollTop = body.scrollHeight;
      }
    }
  </script>
</body>
</html>
