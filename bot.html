<!-- BOT WIDGET COMPLETO PARA REUTILIZAR EN OTRO PROYECTO -->
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bot Widget Reutilizable</title>
  <!-- Fuentes premium -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&family=Orbitron:wght@400;700&family=Exo:wght@400;700&family=Audiowide&family=Roboto+Mono:wght@400;700&family=UnifrakturCook:wght@700&family=Black+Ops+One&family=Press+Start+2P&family=Rubik+Mono+One&family=Permanent+Marker&family=Pacifico&family=Zen+Dots&family=Staatliches&family=Fruktur&display=swap" rel="stylesheet">
  <style>
    /* --- TEMA FUTURISTA OSCURO Y NEÃ“N PARA EL CHATBOT --- */
    .bot-widget {
      background: #f7fafd;
      border-radius: 18px;
      box-shadow: 0 4px 32px 0 #00336622, 0 1px 8px #0002;
      border: 1.5px solid #e3e8ee;
      color: #1a2330;
      width: 340px;
      min-width: 260px;
      max-width: 340px;
      min-height: 420px;
      max-height: 650px;
      overflow: hidden;
      position: fixed;
      right: 40px;
      bottom: 40px;
      z-index: 1200;
      display: flex;
      flex-direction: column;
      animation: botWidgetFadeIn 0.5s cubic-bezier(.4,1.4,.6,1) 1;
      transition: box-shadow 0.2s, transform 0.2s;
      font-family: 'Montserrat', Arial, sans-serif;
    }
    .bot-widget::before {
      display: none;
    }
    .bot-header .bot-gear:hover {
      color: #003366;
      transform: scale(1.1);
    }
    .bot-body {
      background: none;
      color: #1a2330;
      font-size: 1.08rem;
      padding: 1.1rem 1.1rem 0.7rem 1.1rem;
      min-height: 140px;
      max-height: 340px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 0.7rem;
      scroll-behavior: smooth;
      z-index: 1;
    }
    .bot-body .bot-msg {
      z-index: 2;
      display: flex;
      align-items: flex-end;
      gap: 0.7em;
      margin-bottom: 0.2em;
      animation: floatIn 0.5s cubic-bezier(.4,1.4,.6,1);
    }
    .bot-body .bot-msg.bot .bot-bubble {
      background: #e3e8ee;
      color: #003366;
      border-radius: 14px 14px 14px 6px;
      border: 1.5px solid #c2d1e0;
      box-shadow: 0 1px 4px #00336611;
      position: relative;
      overflow: visible;
    }
    .bot-body .bot-msg.user .bot-bubble {
      background: #fff;
      color: #1a2330;
      border-radius: 14px 14px 6px 14px;
      border: 1.5px solid #c2d1e0;
      box-shadow: 0 1px 4px #00336611;
      align-self: flex-end;
    }
    .bot-body .bot-bubble {
      max-width: 80%;
      padding: 0.95em 1.35em;
      font-size: 1.08em;
      word-break: break-word;
      line-height: 1.5;
      position: relative;
      animation: bubbleFloatIn 0.35s cubic-bezier(.4,1.4,.6,1);
      z-index: 2;
    }
    .bot-body .bot-typing {
      font-style: italic;
      color: #00fff7;
      animation: botTypingBlink 1.2s infinite;
    }
    .bot-footer {
      padding: 0.7rem 1.1rem 0.8rem 1.1rem;
      border-top: 1.5px solid #e3e8ee;
      background: #f7fafd;
      display: flex;
      align-items: center;
      box-shadow: none;
    }
    .bot-input {
      flex: 1 1 auto;
      min-width: 0;
      padding: 0.6rem 1rem;
      border-radius: 8px;
      border: 1.5px solid #c2d1e0;
      font-size: 1.08rem;
      background: #fff;
      color: #1a2330;
      outline: none;
      transition: border-color 0.2s, box-shadow 0.2s;
      box-shadow: none;
      margin-right: 0.5rem;
    }
    .bot-input:focus {
      border-color: #003366;
      box-shadow: 0 0 0 2px #00336622;
    }
    .bot-send {
      padding: 0.6rem 1.2rem;
      background: #003366;
      color: #fff;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 700;
      font-size: 1.08rem;
      box-shadow: none;
      transition: background 0.2s, color 0.2s, transform 0.18s;
      letter-spacing: 0.2px;
      margin-left: 0;
    }
    .bot-send:hover {
      background: #0050b3;
      color: #fff;
      transform: scale(1.04);
    }
    @media (max-width: 700px) {
      .bot-widget {
        width: 99vw !important;
        min-width: unset !important;
        max-width: 99vw !important;
        right: 0.5vw;
        bottom: 80px;
        min-height: 100px;
        max-height: 99vh;
      }
      .bot-fab { right: 2vw; }
    }
    /* --- PANEL DE CONFIGURACIÃ“N FUTURISTA --- */
    .bot-config-panel {
      position: absolute;
      top: 60px;
      right: 24px;
      min-width: 270px;
      background: linear-gradient(135deg, #181c2b 60%, #23243a 100%);
      border-radius: 18px;
      box-shadow: 0 8px 32px #00fff733, 0 2px 16px #ff00cc33;
      border: 2px solid #00fff7;
      padding: 1.2rem 1.2rem 1rem 1.2rem;
      z-index: 1002;
      display: none;
      flex-direction: column;
      gap: 1.1rem;
      color: #fff;
      font-family: 'Montserrat', Arial, sans-serif;
      animation: configPanelIn 0.35s cubic-bezier(.4,1.4,.6,1);
    }
    @keyframes configPanelIn {
      from { opacity: 0; transform: translateY(-30px) scale(0.95); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }
    .bot-config-panel label {
      font-size: 1.05rem;
      font-weight: 600;
      margin-bottom: 0.3rem;
      color: #00fff7;
    }
    .bot-config-panel select, .bot-config-panel input[type="color"] {
      width: 100%;
      padding: 0.4rem 0.5rem;
      border-radius: 8px;
      border: 1.5px solid #ff00cc;
      background: #23243a;
      color: #fff;
      font-size: 1.05rem;
      margin-bottom: 0.7rem;
      margin-top: 0.1rem;
    }
    /* ... Puedes agregar mÃ¡s CSS segÃºn tus necesidades ... */
  </style>
</head>
<body>
  <!-- BotÃ³n flotante profesional -->
  <button id="botToggleBtn" class="bot-fab" aria-label="Abrir chat de asistencia" style="
    background: #003366;
    box-shadow: 0 2px 12px #00336633;
    border: 2px solid #e3e8ee;
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    bottom: 40px;
    right: 40px;
    z-index: 1100;
    transition: box-shadow 0.25s, background 0.25s, transform 0.18s;
    overflow: visible;
    border-radius: 50%;
    padding: 0;
  ">
    <img src="UML-Imagenes.png/Imagen de WhatsApp 2025-07-30 a las 13.22.01_ec68b39f.jpg" alt="Logo Tulio" style="width:38px;height:38px;border-radius:50%;object-fit:cover;box-shadow:0 0 8px #00336655;">
  </button>
  <div class="bot-widget" id="botWidget" style="display:none;">
    <div class="bot-header">
      <div style="display:flex;flex-direction:column;align-items:center;gap:0.1em;width:100%;padding-top:0.7em;padding-bottom:0.2em;">
        <!-- Logo del bot como imagen -->
        <span id="genkubAvatar3D" style="display:block;width:74px;height:74px;margin:0 auto;overflow:hidden;border-radius:50%;box-shadow:0 0 16px #00eaffcc;">
          <img src="UML-Imagenes.png/Imagen de WhatsApp 2025-07-30 a las 13.22.01_ec68b39f.jpg" alt="Logo Tulio" style="width:74px;height:74px;border-radius:50%;object-fit:cover;">
        </span>
        <div id="genkubBotText" style="margin-top:0.1em;text-align:center;font-size:1em;font-family:'Orbitron',sans-serif;color:#00f2ff;line-height:1.1;">Â¡Hola, soy Tulio ai asisten-UML!</div>
      </div>
      <div style="display:flex;gap:0.5em;justify-content:flex-end;width:100%;margin-top:-2.2em;margin-bottom:0.5em;">
        <button id="botConfigBtn" class="bot-gear" aria-label="ConfiguraciÃ³n" title="ConfiguraciÃ³n" style="background:none;border:none;font-size:1.3em;color:#003366;cursor:pointer;">&#9881;</button>
        <button id="botCloseBtn" class="bot-close" aria-label="Cerrar chat" style="background:none;border:none;font-size:1.5em;color:#003366;cursor:pointer;">&times;</button>
      </div>
    <div class="bot-config-panel" id="botConfigPanel" style="min-width:220px;">
      <button id="botConfigCloseBtn" style="background:none;border:none;position:absolute;top:10px;left:10px;font-size:1.5rem;color:#003366;cursor:pointer;z-index:10;" title="Cerrar configuraciÃ³n">âŸµ</button>
      <label style="display:flex;justify-content:space-between;align-items:center;">Texto del bot:
        <input type="text" id="genkubTextInput" placeholder="Â¿En quÃ© te ayudo?" style="width:70%;">
      </label>
      <button id="genkubSpeakBtn" style="background:#003366;color:white;font-weight:bold;cursor:pointer;margin-top:0.5em;border-radius:6px;padding:0.4em 1em;border:none;">ðŸ”Š Hablar</button>
    </div>
    <div class="bot-body" id="botBody">
      <div class="bot-msg bot">
        <div class="bot-bubble">Â¡Hola! Â¿En quÃ© puedo ayudarte?</div>
      </div>
      <div class="bot-msg bot bot-typing-msg" id="botTypingMsg" style="display:none;">
        <div class="bot-bubble bot-typing-bubble">
          <span class="bot-typing-dots">
            <span>.</span><span>.</span><span>.</span>
          </span>
        </div>
      </div>
    </div>
    <div class="bot-footer glass-footer">
      <div class="input-glass-wrap" style="display:flex;align-items:center;width:100%;gap:0;">
        <input class="bot-input glass-input" id="botInput" type="text" placeholder="Escribe tu mensaje..." autocomplete="off" />
        <button class="bot-send glass-send" onclick="enviarMensaje()">
          <span>Enviar</span>
          <svg width="22" height="22" viewBox="0 0 22 22" fill="none" style="margin-left:7px;vertical-align:middle;"><defs><linearGradient id="sendGrad" x1="0" y1="0" x2="22" y2="22" gradientUnits="userSpaceOnUse"><stop stop-color="#00fff7"/><stop offset="1" stop-color="#ff00cc"/></linearGradient></defs><path d="M3 19L20 11L3 3V10L15 11L3 12V19Z" fill="url(#sendGrad)"/></svg>
        </button>
      </div>
    </div>
  </div>
  <script>
    // --- FUNCIONALIDAD COMPLETA DEL BOT ---
    // Panel de configuraciÃ³n funcional
    function toggleBotConfigPanel(forceOpen) {
      const panel = document.getElementById('botConfigPanel');
      if (forceOpen === true) {
        panel.classList.add('active');
        return;
      }
      if (forceOpen === false) {
        panel.classList.remove('active');
        return;
      }
      panel.classList.toggle('active');
    }

    // Listeners para abrir/cerrar el panel de configuraciÃ³n
    document.addEventListener('DOMContentLoaded', function() {
      const configBtn = document.getElementById('botConfigBtn');
      const closeBtn = document.getElementById('botConfigCloseBtn');
      if (configBtn) {
        configBtn.onclick = function(e) {
          e.preventDefault();
          toggleBotConfigPanel(true);
        };
      }
      if (closeBtn) {
        closeBtn.onclick = function() {
          toggleBotConfigPanel(false);
        };
      }
    });

    // Temas visuales para el bot (completo)
    const botThemes = {
      futurista: {
        '--bot-bg': 'linear-gradient(135deg, #181c2b 60%, #23243a 100%)',
        '--bot-header-bg': 'rgba(0,80,158,0.82)',
        '--bot-main': '#00fff7',
        '--bot-accent': '#ff00cc',
        '--bot-footer-bg': 'rgba(30,30,40,0.55)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ff00cc 60%, #00fff7 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #23243a 60%, #00fff7 100%)',
      },
      cyberpunk: {
        '--bot-bg': 'linear-gradient(135deg, #1a0033 60%, #ff00cc 100%)',
        '--bot-header-bg': '#ff00cc',
        '--bot-main': '#00fff7',
        '--bot-accent': '#ffea00',
        '--bot-footer-bg': 'rgba(40,0,60,0.7)',
        '--bot-font': 'Audiowide, Orbitron, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ffea00 60%, #00fff7 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #1a0033 60%, #ff00cc 100%)',
      },
      minimalista: {
        '--bot-bg': '#fff',
        '--bot-header-bg': '#222',
        '--bot-main': '#222',
        '--bot-accent': '#888',
        '--bot-footer-bg': '#f4f6fb',
        '--bot-font': 'Roboto Mono, Arial, sans-serif',
        '--bot-user-bubble': '#e0e6f7',
        '--bot-bot-bubble': '#f4f6fb',
      },
      glass: {
        '--bot-bg': 'rgba(255,255,255,0.18)',
        '--bot-header-bg': 'rgba(0,80,158,0.32)',
        '--bot-main': '#00fff7',
        '--bot-accent': '#ff00cc',
        '--bot-footer-bg': 'rgba(255,255,255,0.22)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'rgba(255,255,255,0.55)',
        '--bot-bot-bubble': 'rgba(0,255,247,0.18)',
        '--bot-blur': 'blur(16px) saturate(1.3)',
      },
      aurora: {
        '--bot-bg': 'linear-gradient(120deg, #1ec773 0%, #00509e 40%, #fbc02d 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #00fff7 0%, #ff00cc 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#ff00cc',
        '--bot-footer-bg': 'linear-gradient(90deg, #1ec773 0%, #fbc02d 100%)',
        '--bot-font': 'Exo, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #fbc02d 0%, #1ec773 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #00509e 0%, #00fff7 100%)',
      },
      neon: {
        '--bot-bg': 'linear-gradient(135deg, #0f2027 0%, #2c5364 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #ff00cc 0%, #00fff7 100%)',
        '--bot-main': '#00fff7',
        '--bot-accent': '#ff00cc',
        '--bot-footer-bg': 'rgba(30,30,40,0.85)',
        '--bot-font': 'Audiowide, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ff00cc 60%, #00fff7 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #23243a 60%, #00fff7 100%)',
        '--bot-glow': '0 0 16px #00fff7, 0 0 32px #ff00cc',
      },
      rainbow: {
        '--bot-bg': 'linear-gradient(270deg, #ff00cc, #00fff7, #fbc02d, #ff9800, #1ec773, #ff00cc)',
        '--bot-header-bg': 'linear-gradient(90deg, #ff00cc, #00fff7, #fbc02d)',
        '--bot-main': '#fff',
        '--bot-accent': '#ff00cc',
        '--bot-footer-bg': 'linear-gradient(90deg, #ff00cc, #00fff7, #fbc02d)',
        '--bot-font': 'Orbitron, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ff00cc, #00fff7, #fbc02d)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #00fff7, #fbc02d, #ff00cc)',
      },
      gold: {
        '--bot-bg': 'linear-gradient(135deg, #222 60%, #fbc02d 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #fbc02d 0%, #222 100%)',
        '--bot-main': '#fbc02d',
        '--bot-accent': '#fff',
        '--bot-footer-bg': 'linear-gradient(90deg, #222 0%, #fbc02d 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #fbc02d 60%, #fff 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #222 60%, #fbc02d 100%)',
      },
      matrix: {
        '--bot-bg': 'linear-gradient(135deg, #0f2027 60%, #1ec773 100%)',
        '--bot-header-bg': '#1ec773',
        '--bot-main': '#1ec773',
        '--bot-accent': '#fff',
        '--bot-footer-bg': 'rgba(30,30,40,0.85)',
        '--bot-font': 'Roboto Mono, Arial, monospace',
        '--bot-user-bubble': 'linear-gradient(90deg, #1ec773 60%, #222 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #222 60%, #1ec773 100%)',
      },
      pastel: {
        '--bot-bg': 'linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #fbc2eb 0%, #a6c1ee 100%)',
        '--bot-main': '#a6c1ee',
        '--bot-accent': '#fbc2eb',
        '--bot-footer-bg': 'linear-gradient(90deg, #fbc2eb 0%, #a6c1ee 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #fbc2eb 60%, #a6c1ee 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #a6c1ee 60%, #fbc2eb 100%)',
      },
      galaxy: {
        '--bot-bg': 'radial-gradient(ellipse at 70% 20%, #2b1055 0%, #7597de 60%, #1b1b2f 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #120136 0%, #5f00ba 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#a18cd1',
        '--bot-footer-bg': 'linear-gradient(90deg, #120136 0%, #5f00ba 100%)',
        '--bot-font': 'Orbitron, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #a18cd1 0%, #fbc2eb 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #7597de 60%, #2b1055 100%)',
      },
      lava: {
        '--bot-bg': 'linear-gradient(135deg, #ff512f 0%, #dd2476 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #ff512f 0%, #f09819 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#ff512f',
        '--bot-footer-bg': 'linear-gradient(90deg, #f09819 0%, #ff512f 100%)',
        '--bot-font': 'Audiowide, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ff512f 0%, #f09819 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #dd2476 60%, #ff512f 100%)',
      },
      aqua: {
        '--bot-bg': 'linear-gradient(135deg, #43cea2 0%, #185a9d 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #43cea2 0%, #185a9d 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#43cea2',
        '--bot-footer-bg': 'linear-gradient(90deg, #43cea2 0%, #185a9d 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #43cea2 0%, #185a9d 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #185a9d 60%, #43cea2 100%)',
      },
      sunset: {
        '--bot-bg': 'linear-gradient(135deg, #ff9966 0%, #ff5e62 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #ff9966 0%, #ff5e62 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#ff5e62',
        '--bot-footer-bg': 'linear-gradient(90deg, #ff9966 0%, #ff5e62 100%)',
        '--bot-font': 'Exo, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ff9966 0%, #ff5e62 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #ff5e62 60%, #ff9966 100%)',
      },
      mint: {
        '--bot-bg': 'linear-gradient(135deg, #a8ff78 0%, #78ffd6 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #a8ff78 0%, #78ffd6 100%)',
        '--bot-main': '#222',
        '--bot-accent': '#78ffd6',
        '--bot-footer-bg': 'linear-gradient(90deg, #a8ff78 0%, #78ffd6 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #a8ff78 0%, #78ffd6 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #78ffd6 60%, #a8ff78 100%)',
      },
      peach: {
        '--bot-bg': 'linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #ffecd2 0%, #fcb69f 100%)',
        '--bot-main': '#222',
        '--bot-accent': '#fcb69f',
        '--bot-footer-bg': 'linear-gradient(90deg, #ffecd2 0%, #fcb69f 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #ffecd2 0%, #fcb69f 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #fcb69f 60%, #ffecd2 100%)',
      },
      ice: {
        '--bot-bg': 'linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #e0eafc 0%, #cfdef3 100%)',
        '--bot-main': '#185a9d',
        '--bot-accent': '#cfdef3',
        '--bot-footer-bg': 'linear-gradient(90deg, #e0eafc 0%, #cfdef3 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #e0eafc 0%, #cfdef3 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #cfdef3 60%, #e0eafc 100%)',
      },
      forest: {
        '--bot-bg': 'linear-gradient(135deg, #11998e 0%, #38ef7d 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #11998e 0%, #38ef7d 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#11998e',
        '--bot-footer-bg': 'linear-gradient(90deg, #11998e 0%, #38ef7d 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #11998e 0%, #38ef7d 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #38ef7d 60%, #11998e 100%)',
      },
      berry: {
        '--bot-bg': 'linear-gradient(135deg, #f857a6 0%, #ff5858 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #f857a6 0%, #ff5858 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#f857a6',
        '--bot-footer-bg': 'linear-gradient(90deg, #f857a6 0%, #ff5858 100%)',
        '--bot-font': 'Montserrat, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #f857a6 0%, #ff5858 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #ff5858 60%, #f857a6 100%)',
      },
      retro: {
        '--bot-bg': 'linear-gradient(135deg, #fc466b 0%, #3f5efb 100%)',
        '--bot-header-bg': 'linear-gradient(90deg, #fc466b 0%, #3f5efb 100%)',
        '--bot-main': '#fff',
        '--bot-accent': '#fc466b',
        '--bot-footer-bg': 'linear-gradient(90deg, #fc466b 0%, #3f5efb 100%)',
        '--bot-font': 'Orbitron, Audiowide, Arial, sans-serif',
        '--bot-user-bubble': 'linear-gradient(90deg, #fc466b 0%, #3f5efb 100%)',
        '--bot-bot-bubble': 'linear-gradient(120deg, #3f5efb 60%, #fc466b 100%)',
      }
    };

    function applyBotTheme(themeName) {
      const theme = botThemes[themeName];
      if (!theme) return;
      const root = document.documentElement;
      for (const key in theme) {
        root.style.setProperty(key, theme[key]);
      }
      document.querySelectorAll('.bot-body .bot-msg.user .bot-bubble').forEach(el => {
        el.style.background = theme['--bot-user-bubble'];
      });
      document.querySelectorAll('.bot-body .bot-msg.bot .bot-bubble').forEach(el => {
        el.style.background = theme['--bot-bot-bubble'];
      });
      const widget = document.querySelector('.bot-widget');
      if (widget) widget.style.background = theme['--bot-bg'];
      const header = document.querySelector('.bot-header');
      if (header) header.style.background = theme['--bot-header-bg'];
      const footer = document.querySelector('.bot-footer');
      if (footer) footer.style.background = theme['--bot-footer-bg'];
      if (widget) widget.style.fontFamily = theme['--bot-font'];
    }

    // Mostrar/Ocultar animaciÃ³n escribiendo
    function mostrarEscribiendo(mostrar=true) {
      const typingMsg = document.getElementById('botTypingMsg');
      if (typingMsg) typingMsg.style.display = mostrar ? '' : 'none';
    }

    // Abrir/cerrar el bot flotante
    document.addEventListener('DOMContentLoaded', function() {
      const botWidget = document.getElementById('botWidget');
      const botToggleBtn = document.getElementById('botToggleBtn');
      const botCloseBtn = document.getElementById('botCloseBtn');
      if (botToggleBtn && botWidget) {
        botToggleBtn.onclick = function() {
          botWidget.style.display = 'flex';
          botWidget.style.transform = 'scale(1)';
          botWidget.style.width = '600px';
          botWidget.style.maxWidth = '600px';
          botWidget.style.minWidth = '340px';
          botWidget.style.minHeight = '420px';
          botWidget.style.maxHeight = '700px';
          document.getElementById('botInput').focus();
          botToggleBtn.style.display = 'none';
        };
      }
      if (botCloseBtn && botWidget && botToggleBtn) {
        botCloseBtn.onclick = function() {
          botWidget.style.transform = 'scale(0.8)';
          setTimeout(() => {
            botWidget.style.display = 'none';
            botToggleBtn.style.display = 'flex';
          }, 180);
        };
      }
      // Escape para cerrar
      document.addEventListener('keydown', function(e) {
        if(botWidget.style.display === 'flex' && e.key === 'Escape') {
          botWidget.style.transform = 'scale(0.8)';
          setTimeout(() => {
            botWidget.style.display = 'none';
            botToggleBtn.style.display = 'flex';
          }, 180);
        }
      });
      // Enter para enviar mensaje
      document.getElementById('botInput').addEventListener('keydown', function(e) {
        if(e.key === 'Enter') enviarMensaje();
      });
    });

    // Hacer la ventana del bot arrastrable
    document.addEventListener('DOMContentLoaded', function() {
      let isDragging = false, dragOffsetX = 0, dragOffsetY = 0;
      const botWidget = document.getElementById('botWidget');
      const header = botWidget.querySelector('.bot-header');
      header.style.cursor = 'move';
      header.addEventListener('mousedown', function(e) {
        isDragging = true;
        botWidget.classList.add('dragging');
        const rect = botWidget.getBoundingClientRect();
        dragOffsetX = e.clientX - rect.left;
        dragOffsetY = e.clientY - rect.top;
        document.body.style.userSelect = 'none';
      });
      document.addEventListener('mousemove', function(e) {
        if(isDragging) {
          let x = e.clientX - dragOffsetX;
          let y = e.clientY - dragOffsetY;
          x = Math.max(0, Math.min(window.innerWidth - botWidget.offsetWidth, x));
          y = Math.max(0, Math.min(window.innerHeight - botWidget.offsetHeight, y));
          botWidget.style.left = x + 'px';
          botWidget.style.top = y + 'px';
          botWidget.style.right = 'auto';
          botWidget.style.bottom = 'auto';
          botWidget.style.position = 'fixed';
        }
      });
      document.addEventListener('mouseup', function() {
        if(isDragging) {
          isDragging = false;
          botWidget.classList.remove('dragging');
          document.body.style.userSelect = '';
        }
      });
    });

    // SimulaciÃ³n de envÃ­o de mensaje (puedes conectar a tu backend aquÃ­)
    async function enviarMensaje() {
      const input = document.getElementById('botInput');
      const body = document.getElementById('botBody');
      const userMsg = input.value.trim();
      if(userMsg !== '') {
        const userDiv = document.createElement('div');
        userDiv.className = 'bot-msg user';
        userDiv.innerHTML = `<div class="bot-bubble">${userMsg}</div>`;
        body.appendChild(userDiv);
        body.scrollTop = body.scrollHeight;
        input.value = '';
        // Mostrar indicador de "escribiendo"
        const loadingId = 'bot-loading-' + Date.now();
        const botDiv = document.createElement('div');
        botDiv.className = 'bot-msg bot';
        botDiv.id = loadingId;
        botDiv.innerHTML = `<div class="bot-bubble"><span class='bot-typing'>Escribiendo...</span></div>`;
        body.appendChild(botDiv);
        body.scrollTop = body.scrollHeight;
        try {
          // Generar UUID para la sesiÃ³n
          const uuid = crypto.randomUUID();
          const response = await fetch('https://automate.danild.dev/webhook/chatbot', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ question: userMsg, sessionId: uuid })
          });
          let data = await response.json();
          let respuesta = data.answer || data.response;
          // Si sigue sin respuesta, busca la primera propiedad string
          if (!respuesta && typeof data === 'object' && data !== null) {
            for (const key in data) {
              if (typeof data[key] === 'string' && data[key].length > 0) {
                respuesta = data[key];
                break;
              }
            }
          }
          if (respuesta) {
            botDiv.innerHTML = `<div class="bot-bubble">${respuesta}</div>`;
          } else {
            botDiv.innerHTML = `<div class="bot-bubble" style='color:red;'>No se pudo interpretar la respuesta del servidor.</div>`;
          }
        } catch (err) {
          botDiv.innerHTML = `<div class="bot-bubble" style='color:red;'>Error de conexiÃ³n. Intenta de nuevo.</div>`;
        }
        body.scrollTop = body.scrollHeight;
      }
    }
  </script>
</body>
</html>
